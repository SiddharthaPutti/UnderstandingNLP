<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>Transformers? | Sid&#39;IO</title>
<meta name="keywords" content="nlp, language-model, alignment, steerability, prompting" />
<meta name="description" content="All this is going to be in lame/understandable language.">
<meta name="author" content="Siddhartha Putti">
<link rel="canonical" href="https://siddharthaputti.github.io//posts/transformers/" />
<link crossorigin="anonymous" href="/assets/css/stylesheet.min.67a6fb6e33089cb29e856bcc95d7aa39f70049a42b123105531265a0d9f1258b.css" integrity="sha256-Z6b7bjMInLKehWvMldeqOfcASaQrEjEFUxJloNnxJYs=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.min.7680afc38aa6b15ddf158a4f3780b7b1f7dde7e91d26f073e6229bb7a0793c92.js" integrity="sha256-doCvw4qmsV3fFYpPN4C3sffd5&#43;kdJvBz5iKbt6B5PJI="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://siddharthaputti.github.io/doge.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://siddharthaputti.github.io/favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://siddharthaputti.github.io/favicon-32x32.png">
<link rel="apple-touch-icon" href="https://siddharthaputti.github.io/apple-touch-icon.png">
<link rel="mask-icon" href="https://siddharthaputti.github.io/safari-pinned-tab.svg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
    <style>
        @media (prefers-color-scheme: dark) {
            :root {
                --theme: rgb(29, 30, 32);
                --entry: rgb(46, 46, 51);
                --primary: rgb(218, 218, 219);
                --secondary: rgb(155, 156, 157);
                --tertiary: rgb(65, 66, 68);
                --content: rgb(196, 196, 197);
                --hljs-bg: rgb(46, 46, 51);
                --code-bg: rgb(55, 56, 62);
                --border: rgb(51, 51, 51);
            }

            .list {
                background: var(--theme);
            }

            .list:not(.dark)::-webkit-scrollbar-track {
                background: 0 0;
            }

            .list:not(.dark)::-webkit-scrollbar-thumb {
                border-color: var(--theme);
            }
        }

    </style>
</noscript>
<script async src="https://www.googletagmanager.com/gtag/js?id=G-HFT45VFBX6"></script>
<script>
var doNotTrack = false;
if (!doNotTrack) {
	window.dataLayer = window.dataLayer || [];
	function gtag(){dataLayer.push(arguments);}
	gtag('js', new Date());
	gtag('config', 'G-HFT45VFBX6', { 'anonymize_ip': false });
}
</script>
<meta property="og:title" content="Transformers?" />
<meta property="og:description" content="All this is going to be in lame/understandable language." />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://siddharthaputti.github.io//posts/transformers/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-03-15T00:00:00&#43;00:00" />
<meta property="article:modified_time" content="2023-03-15T00:00:00&#43;00:00" />


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [
    {
      "@type": "ListItem",
      "position":  1 ,
      "name": "Posts",
      "item": "https://siddharthaputti.github.io//posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "Word Embedding",
      "item": "https://siddharthaputti.github.io//posts/transformers/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "Topic Modeling",
  "name": "Topic Modeling",
  "description": "All this is going to be in lame/understandable language.",
  "keywords": [
    "nlp", "language-model", "alignment", "steerability", "prompting"
  ],
  "articleBody": "",
   "wordCount" : "4428",
  "inLanguage": "en",
  "datePublished": "2023-03-15T00:00:00Z",
  "dateModified": "2023-03-15T00:00:00Z",
  "author":{
    "@type": "Person",
    "name": "Siddhartha Putti"
  },
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://siddharthaputti.github.io//posts/transformers/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "Sid'IO",
    "logo": {
      "@type": "ImageObject",
      "url": "https://siddharthaputti.github.io/doge.png"
    }
  }
}
</script>
</head>

<body class="" id="top">
<script>
    if (localStorage.getItem("pref-theme") === "dark") {
        document.body.classList.add('dark');
    } else if (localStorage.getItem("pref-theme") === "light") {
        document.body.classList.remove('dark')
    } else if (window.matchMedia('(prefers-color-scheme: dark)').matches) {
        document.body.classList.add('dark');
    }

</script>

<script>
  MathJax = {
    tex: {
      inlineMath: [['$', '$'], ['\\(', '\\)']],
      displayMath: [['$$','$$'], ['\\[', '\\]']],
      processEscapes: true,
      processEnvironments: true
    },
    options: {
      skipHtmlTags: ['script', 'noscript', 'style', 'textarea', 'pre']
    }
  };

  window.addEventListener('load', (event) => {
      document.querySelectorAll("mjx-container").forEach(function(x){
        x.parentElement.classList += 'has-jax'})
    });

</script>
<script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>


<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://siddharthaputti.github.io/" accesskey="h" title="Sid&#39;IO (Alt + H)">Sid&#39;IO</a>
            <span class="logo-switches">
                <button id="theme-toggle" accesskey="t" title="(Alt + T)">
                    <svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path>
                    </svg>
                    <svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"
                        fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round"
                        stroke-linejoin="round">
                        <circle cx="12" cy="12" r="5"></circle>
                        <line x1="12" y1="1" x2="12" y2="3"></line>
                        <line x1="12" y1="21" x2="12" y2="23"></line>
                        <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
                        <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
                        <line x1="1" y1="12" x2="3" y2="12"></line>
                        <line x1="21" y1="12" x2="23" y2="12"></line>
                        <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
                        <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
                    </svg>
                </button>
            </span>
        </div>
        <ul id="menu">
            <li>
                <a href="https://siddharthaputti.github.io/faq" title="FAQ">
                    <span>FAQ</span>
                </a>
            </li>
           
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    
    <h1 class="post-title">
      Transformers
    </h1>
    <div class="post-meta"><span title='2023-03-15 00:00:00 +0000 UTC'>Feb 20, 2023</span>&nbsp;·&nbsp;10 min&nbsp;·&nbsp; Siddhartha Putti
    </div>
  <div class="post-content"><p>we know that text is sequential data. Networks like LSTM contain feedback loops that allow information to propagate from one step to another. These types of architectures are mainly used for speech processing and time series. You can find more details in this amazing blog post by Andrej Karpathy: The Unreasonable Effectiveness of RNN.</p>
<p>One of the main areas where RNN showed prominence is machine translation: changing text from one language to another. This type of machine translation model is built by using encoder-decoder architecture or seq-to-seq architectures(input and output are diff lengths).</p>

<ol>
    <li><p>The encoder encodes the information into a numerical sequence which is generally called a hidden state,which is the output of encoder.</p></li>
    <li><p>This state is passed to the decoder. and the decoder outputs the sequence one word at a time.</p></li>
    <li><p>The main drawback of this kind of architecture:</p>
    <ul>
        <li><p>The hidden state creates an information bottleneck, which means it has to represent the entire meaning in a single hidden state.</p></li>
    <li><p>If there is a long sequence, the information may be lost in encoding the whole sequence into a compressed format.</p></li>
    <li><p>This could be overcome by providing all of the encoder state's information to the decoder. This is called "ATTENTION".</p></li></ul>
</ol>
<p>GPT: As the name says it is a pre-trained transformer for generating text.</p>
<p>BERT: This is also called masked-language-modeling. The objective is to find the randomly masked words in a text.</p>

<h2 id="ATTENTION">ATTENTION<a hidden class="anchor" aria-hidden="true" href="#ATTENTION">#</a></h2>
<ul>
    <li><p>The main idea is instead of producing a single hidden state, the encoder(BERT) makes a representation of all the hidden states at each step that the decoder(GPT) can access.</p></li>
    <li><p>As you thought of it by now, representing all the hidden states makes it a large matrix for the decoder input, you need a mechanism to prioritize which states to expose to the decoder.</p></li>
    <li><p>This is where attention is prominent, the decoder assigns weight to the states of the encoder at every decoding step.</p></li>
    <li><p>Another shortcoming is, since the mechanism is sequential, we can not process this in parallel, The "SELF-ATTENTION" mechanism paved the way for parallel executions.</p></li>
    <li><p>The basic idea is to operate attention on all states in the same layer of the neural network, and then fed into the feed-forward neural network. that is both encoder and decoder have self-attention mechanisms. this way it can be trained much faster than RNN models.</p></li>
    <ul><li><p>As we do not have most of the resources to collect large amounts of datasets to create a model for machine translation, hugging face provides pre-trained models. that the weights of the entire architecture are provided, such that we can use the pre-trained version of the model on our available comparatively smaller dataset to fine-tune. this process is called "TRANSFER LEARNING".</p></li></ul>
</ul>

<ul>To simplify for those unfamiliar with these architectures, think of the process as a team working on a puzzle. The encoder (BERT) examines every piece (word), 
    understanding its details and position. Instead of deciding where each piece goes, it makes notes (hidden states) on each. The decoder (GPT) then uses these notes to put the puzzle together, 
    deciding the placement one piece at a time. Attention is like giving the decoder a magnifying glass to focus on the most relevant notes first. Self-attention lets all team members (words) 
    simultaneously share insights, speeding up the puzzle-solving. Transfer learning is akin to starting with a partially completed puzzle, using patterns recognized in previous puzzles 
    (pre-trained models) to help finish the new one faster.</ul>

<h2 id="Hugging Face">Hugging Face<a hidden class="anchor" aria-hidden="true" href="#Hugging_Face">#</a></h2>
<ul>
    <li><p>pipelines: This pipeline() method from hugging face abstracts away all the steps need to convert raw text into set of predictions from a pre-trained/fine-tuned model.</p></li>
</ul>
<p><pre tabindex="0"><code>  
    import pandas as pd
    from transformers import pipeline
    classifier = pipeline('text-classification')
    text = """ I really love that movie"""
    pd.DataFrame(classifier(text))
    
    output: 	label	    score
            0	POSITIVE	0.999877
    
</code></pre></p>
<ul>
    <li><p>In this the model is very confident that this is a positive sentiment. This demonstrates one of the common tasks to perform using hugging face pre-trained transformers. similarly, you can perform tasks such as: Named Entity Recognition, summarization, Question Answering, Translation, and text Generation.</p></li>
</ul>
<p><pre tabindex="0"><code>  
    # NER
    ner_tagger = pipeline("ner", aggregation_strategy="simple") 
    # Q-A
    reader = pipeline("question-answering")
    outputs = reader(question=question, context=text)
    # Translation english to german
    translator = pipeline("translation_en_to_de",
    model="Helsinki-NLP/opus-mt-en-de")
    outputs = translator(text, clean_up_tokenization_spaces=True, min_length=100)
    # text generation
    generator = pipeline("text-generation")
    outputs = generator(prompt, max_length=200)
    
</code></pre></p>

  <footer class="post-footer">

<nav class="paginav">
  <a class="prev" href="/posts/topic_modeling/">
    <span class="title">« </span>
    <br>
    <span>Topic Modeling</span>
  </a>
  <!-- <a class="next" href="https://siddharthaputti.github.io/posts/word_embedding/">
    <span class="title"> »</span>
    <br>
    <span>Stay tuned!</span>
  </a> -->
</nav>



  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>&copy; 2023 <a href="https://siddharthaputti.github.io/">Sid&#39;IO</a></span>
    <span>
        Powered by
        <a href="https://gohugo.io/" rel="noopener noreferrer" target="_blank">Hugo</a> &
        <a href="https://git.io/hugopapermod" rel="noopener" target="_blank">PaperMod</a>
    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.getElementById("theme-toggle").addEventListener("click", () => {
        if (document.body.className.includes("dark")) {
            document.body.classList.remove('dark');
            localStorage.setItem("pref-theme", 'light');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem("pref-theme", 'dark');
        }
    })

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerText = 'copy';

        function copyingDone() {
            copybutton.innerText = 'copied!';
            setTimeout(() => {
                copybutton.innerText = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
